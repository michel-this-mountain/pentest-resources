FROM debian:latest

RUN apt-get update
RUN apt-get install -y ca-certificates gnupg wget

RUN wget -q -O - https://archive.kali.org/archive-key.asc  | apt-key add -
RUN echo "deb http://http.kali.org/kali kali-rolling main contrib non-free" >> /etc/apt/sources.list
RUN apt-get update

RUN apt-get install -y python3 python3-pip git seclists curl dnsrecon enum4linux feroxbuster gobuster impacket-scripts nbtscan nikto nmap onesixtyone oscanner redis-tools smbclient smbmap snmp sslscan sipvicious tnscmd10g whatweb wkhtmltopdf python3-venv

# Create a virtual environment and install AutoRecon
RUN python3 -m venv /opt/myenv
RUN /opt/myenv/bin/pip install --upgrade pip
RUN /opt/myenv/bin/pip install git+https://github.com/Tib3rius/AutoRecon.git

# Ensure proper permissions for the virtual environment
RUN chmod -R 755 /opt/myenv

# Create results directory
RUN mkdir results

# Set the default command
CMD ["sleep", "infinity"]

# Example of running autorecon using the virtual environment
# docker exec -it autorecon-container /bin/bash -c "/opt/myenv/bin/activate && autorecon demo.testfire.net"